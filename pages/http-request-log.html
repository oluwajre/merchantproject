<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Creditswitch Merchant Portal | Http Request Log</title>
        <link rel="stylesheet" href="../styles/output.css" />
        <link rel="apple-touch-icon" sizes="180x180" href="../assets/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../assets/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../assets/favicon-16x16.png">
        <link rel="manifest" href="../assets/site.webmanifest">
    </head>
    <body class="select-none bg-primary-sidebar-gray-background font-roboto">

        <section class="relative flex h-screen" x-data="menu('Http Requests Log')">

            <!-- Sidebar Component -->
            <div id="sidebarContainer" x-ref="sidebarContainer"></div>
            

            <!-- Right Hand Section -->
            <div class="flex-1 overflow-y-auto flex flex-col min-h-screen" id="screenTop">

                <!-- Mobile Nav Component  -->
                <div id="mobileNavContainer" x-ref="mobileNavContainer"></div>

                <!-- Header Section Component 1  -->
                <div class="w-full flex flex-col sm:flex-row flex-wrap gap-2 justify-between items-start sm:items-center pl-9 pr-6 my-5 font-roboto">
                    <div class="flex items-center capitalize gap-3">
                        <p class="flex items-center text-small">
                            <span class="mr-2 text-primary-header-gray-bold">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                                </svg>
                            </span>
                        </p>
                    </div>
                    <div class="flex gap-2 text-[10px] font-medium uppercase text-primary-header-gray-text">
                        <div class="px-3 py-2 bg-primary-header-gray-background cursor-pointer">Total Merchants: <span class="text-primary-blue-text">103</span></div>
                        <div class="px-6 py-2 bg-primary-header-gray-background shadow-md hover:shadow-lg cursor-pointer">Welcome, <span class="text-primary-blue-text">SEGU</span></div>
                    </div>
                </div>

                <!-- Header Section Component 2  -->
                <div class="w-full flex flex-col sm:flex-row flex-wrap gap-2 justify-between items-start sm:items-center px-6 mt-5 mb-4 font-roboto">
                    <div class="flex items-center capitalize gap-3">
                        <p class="font-medium text-primary-header-black-text">Dashboard</p>
                        <p class="flex items-center text-small">
                            <span class="mr-2 text-primary-header-gray-bold">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                                </svg>
                            </span>
                            <a :href="currentPageDetail.link" x-text="currentPageDetail.name" class="font-medium text-primary-header-gray-text"></a>
                        </p>
                    </div>
                    <div class="flex items-center gap-2 text-[10px] font-medium uppercase text-primary-header-gray-text">
                        <div class="px-6 py-2 bg-primary-header-gray-background shadow-md hover:shadow-lg cursor-pointer">Welcome, <span class="text-primary-blue-text">SEGU</span></div>
                        <!-- <div class="relative">

                        </div> -->
                        <div class="cursor-pointer relative group inline-block" x-data="{showPopUp: false}" @click="showPopUp = !showPopUp" @click.away="showPopUp = false">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon kt-svg-icon--success kt-svg-icon--md size-7">
                                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <polygon id="Shape" points="0 0 24 0 24 24 0 24"></polygon>
                                    <path d="M5.85714286,2 L13.7364114,2 C14.0910962,2 14.4343066,2.12568431 14.7051108,2.35473959 L19.4686994,6.3839416 C19.8056532,6.66894833 20,7.08787823 20,7.52920201 L20,20.0833333 C20,21.8738751 19.9795521,22 18.1428571,22 L5.85714286,22 C4.02044787,22 4,21.8738751 4,20.0833333 L4,3.91666667 C4,2.12612489 4.02044787,2 5.85714286,2 Z" id="Combined-Shape" fill="#1dc9b7" fill-rule="nonzero" opacity="0.3"></path>
                                    <path d="M11,14 L9,14 C8.44771525,14 8,13.5522847 8,13 C8,12.4477153 8.44771525,12 9,12 L11,12 L11,10 C11,9.44771525 11.4477153,9 12,9 C12.5522847,9 13,9.44771525 13,10 L13,12 L15,12 C15.5522847,12 16,12.4477153 16,13 C16,13.5522847 15.5522847,14 15,14 L13,14 L13,16 C13,16.5522847 12.5522847,17 12,17 C11.4477153,17 11,16.5522847 11,16 L11,14 Z" id="Combined-Shape" fill="#1dc9b7"></path>
                                </g>
                            </svg>

                            <div class="absolute left-[80%] -translate-x-[80%] top-9 mb-2 hidden group-hover:block bg-white normal-case font-normal text-primary-filtered-options font-poppins text-xs py-3 px-4 z-30 whitespace-nowrap shadow-md">
                                <div class="absolute -top-[6px] left-[80%] -translate-x-[80%] w-0 h-0 border-l-7 border-b-7 border-r-7 border-l-transparent border-r-transparent border-b-white"></div>
                                Quick action
                            </div>

                            <div 
                                x-show="showPopUp"
                                x-transition:enter="transition ease-out duration-200"
                                x-cloak
                                class="absolute text-tiny font-medium bg-white shadow-sm py-2 top-full right-0 w-[160px] z-20 transform text-left"
                            >
                                <p class="uppercase text-primary-blue-text mb-1 px-6 py-2">ADD NEW:</p>
                                
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Content Section -->
                <div class="mt-10 w-full flex flex-col px-6 pt-6 pb-4 gap-12 text-primary-black">
                    
                    <div class="flex flex-col gap-12 w-full">
                        
                        <div class="flex-1 relative pt-14 pb-3 bg-white shrink-0 w-full">
                            <div class="absolute flex items-center align-middle justify-center gap-1 -top-5 mx-4 p-4 text-center rounded-xs cyanBlue-custom-box-shadow cyanBlue-custom-background-gradient text-white min-w-[160px]">
                                <span class="text-white">
                                    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 -960 960 960' fill='currentColor' class='size-7'>
                                        <path d='M0-240v-63q0-43 44-70t116-27q13 0 25 .5t23 2.5q-14 21-21 44t-7 48v65H0Zm240 0v-65q0-32 17.5-58.5T307-410q32-20 76.5-30t96.5-10q53 0 97.5 10t76.5 30q32 20 49 46.5t17 58.5v65H240Zm540 0v-65q0-26-6.5-49T754-397q11-2 22.5-2.5t23.5-.5q72 0 116 26.5t44 70.5v63H780Zm-455-80h311q-10-20-55.5-35T480-370q-55 0-100.5 15T325-320ZM160-440q-33 0-56.5-23.5T80-520q0-34 23.5-57t56.5-23q34 0 57 23t23 57q0 33-23 56.5T160-440Zm640 0q-33 0-56.5-23.5T720-520q0-34 23.5-57t56.5-23q34 0 57 23t23 57q0 33-23 56.5T800-440Zm-320-40q-50 0-85-35t-35-85q0-51 35-85.5t85-34.5q51 0 85.5 34.5T600-600q0 50-34.5 85T480-480Zm0-80q17 0 28.5-11.5T520-600q0-17-11.5-28.5T480-640q-17 0-28.5 11.5T440-600q0 17 11.5 28.5T480-560Zm1 240Zm-1-280Z'/>
                                    </svg>
                                </span>
                                <span class="text-md font-medium">Query Http Request Logs</span>
                            </div>

                            <div class="w-full px-4 mb-7" x-data="{
                                    formData: {
                                        merchantName: '',
                                        date: '',
                                        requestId: '',
                                    },
                                    merchantOptions: [
                                        { name: 'Wema Bank - 09137819540' },
                                        { name: 'Sterling Bank - 09137819540' }
                                    ],
                                    showMerchantOptions: false,
                                    get filteredMerchantOptions() {
                                        if (!this.formData.merchantName) return [];
                                        return this.merchantOptions.filter(opt =>
                                            opt.name.toLowerCase().includes(this.formData.merchantName.toLowerCase())
                                        );
                                    },
                                    escapeRegExp(string) {
                                        return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                                    },
                                    highlightMatch(text) {
                                        const regex = new RegExp(`(${this.escapeRegExp(this.formData.merchantName)})`, 'gi');
                                        return text.replace(regex, `<span class='font-bold'>$1</span>`);
                                    },
                                }">
                                <form class="w-full pl-4 gap-5 grid grid-cols-1 md:grid-cols-3 justify-between" @submit.prevent>
                                    <div class="relative">
                                        <input
                                            x-model="formData.merchantName"
                                            @input="showMerchantOptions = true"
                                            @click.away="showMerchantOptions = false"
                                            type="text"
                                            placeholder="Select with merchant name or phone number"
                                            name="merchantName"
                                            id="merchantName"
                                            autocomplete="off"
                                            class="w-full border border-primary-sidebar-gray-text focus:border-primary-inputBorder-blue placeholder:text-primary-footer-gray-text outline-none px-3 py-2 text-small transition duration-300 text-primary-footer-gray-text focus:text-primary-input-black-text font-normal"
                                        >
                                        
                                        <div x-show="showMerchantOptions && filteredMerchantOptions.length > 0"
                                            class="absolute inset-x-0 w-full max-w-[350px] left-0 bg-white z-30 shadow-md text-small text-primary-header-gray-bold font-light"
                                            x-transition.origin.top>                                
                                            <template x-for="option in filteredMerchantOptions" :key="option.name">
                                                <div class="w-full px-2 py-1 border-b border-primary-sidebar-gray-text/30 hover:bg-perinwinkleBlue-light hover:text-primary-royalBlue-vivid cursor-pointer transition duration-100"
                                                    @click="formData.merchantName = option.name; showMerchantOptions = false">
                                                    <p x-html="highlightMatch(option.name)"></p>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                    <div>
                                        <input
                                            x-model="formData.date"
                                            type="date"
                                            name="date" 
                                            id="date"
                                            class="w-full border border-primary-sidebar-gray-text focus:border-primary-inputBorder-blue font-normal placeholder:text-primary-input-gray-text outline-none px-3 py-2 text-small transition duration-300 text-primary-input-gray-text"
                                        >
                                        <label for="date" class="text-tiny text-primary-header-gray-bold">(Date)</label>
                                    </div>
                                    <div>
                                        <input
                                            x-model="formData.requestId"
                                            type="text"
                                            placeholder="Request Id"
                                            name="requestId"
                                            id="requestId"
                                            class="w-full border border-primary-sidebar-gray-text focus:border-primary-inputBorder-blue placeholder:text-primary-footer-gray-text outline-none px-3 py-2 text-small transition duration-300 text-primary-footer-gray-text focus:text-primary-input-black-text font-normal"
                                        >
                                        <label for="requestId" class="text-tiny text-primary-header-gray-bold">(Request Id)</label>
                                    </div>
                                    <div>
                                        <button type="submit" class="w-full uppercase font-semibold text-tiny text-white bg-primary-cyanBlue-button-background hover:bg-primary-cyanBlue-background-dark active:bg-primary-blue-text p-3 rounded-xs cursor-pointer transition duration-300">search</button>
                                    </div>
                                </form>  
                            </div>  
                        </div>

                        <div class="flex-1 relative bg-white shrink-0 w-full rounded-sm shadow-lg" x-data="{
                            currentPage: 1,
                            perPage: 10,
                            tableData: [
                                {
                                    date: '2025-07-16 16:54:23',
                                    merchant: '',
                                    serviceId: '',
                                    requestId: '',
                                    recipient: '',
                                    ip: '41.184.162.110',
                                    uri: '/http-request-log',
                                    payload: '[]',
                                },
                            ],
                            get startPaginatedIndex() {
                                return (this.currentPage - 1) * Number(this.perPage);
                            },
                            get endPaginatedIndex() {
                                return this.startPaginatedIndex + Number(this.perPage);
                            },
                            get paginatedData() {
                                return this.tableData.slice(this.startPaginatedIndex, this.endPaginatedIndex);
                            },
                            get totalPages() {
                                return Math.ceil(this.tableData.length / Number(this.perPage));
                            },
                            goToPage(page) {
                                if (page >= 1 && page <= this.totalPages) {
                                    this.currentPage = page;
                                }
                            },
                            get pageWindow() {
                                const pages = this.totalPages;
                                let start = this.currentPage - 1;
                                if (start < 1) start = 1;
                                let end = start + 7;
                                if (end > pages) {
                                    end = pages;
                                    start = Math.max(1, end - 7);
                                }
                                return Array.from({ length: end - start + 1 }, (_, i) => start + i);
                            },
                        }">

                            <div class="w-full flex flex-col sm:flex-row items-center justify-between gap-4 py-2 px-6 border-b border-primary-sidebar-gray-text/70">
                                <div>
                                    <h1 class="text-primary-table-header font-medium">Http Request Logs</h1>
                                </div>
                                <div class="w-full sm:w-fit">
                                    <button 
                                        class="uppercase text-[10px] font-medium py-3 px-7 bg-primary-green-light hover:brightness-95 rounded-xs text-white cursor-pointer transition duration-200"
                                        @click="window.location.href = './http-request-log.html'"
                                    >
                                        REFRESH PAGE (X)
                                    </button>
                                </div>

                            </div>

                            <!-- Table Summary Header  -->
                            <div class="w-full px-6 mt-4 gap-3 sm:gap-0 flex flex-col sm:flex-row items-center justify-between">
                                <div class="w-full sm:w-fit flex-1 text-left" x-data="{
                                    totalRequests: 1495,
                                    now: new Date(),
                                    get formattedDate() { 
                                        return `${String(this.now.getDate()).padStart(2, '0')}-${String(this.now.getMonth() + 1).padStart(2, '0')}-${String(this.now.getFullYear()).slice(-2)}`
                                    }}">
                                    <h1 x-text="totalRequests" class="text-lg font-semibold text-primary-header-gray-bold">1484</h1>
                                    <p x-text="`${formattedDate} Total Requests`" class="text-small text-primary-footer-gray-text font-medium"></p>
                                </div>
                            </div>

                            <!-- Table Component  -->
                            <div class="overflow-x-auto my-4 px-4 max-w-full flex-1 font-roboto">
                                <template x-if="tableData.length > 0 && paginatedData.length > 0">
                                    <div class="min-w-fit">
                                        <table class="w-full table-auto text-primary-black font-medium border-collapse border border-primary-sidebar-gray-text/70 text-small">
                                            <thead class="align-bottom">
                                                <tr>
                                                    <td class="border border-primary-sidebar-gray-text/70 pl-2 pr-1 sm:pr-5 py-3">Date/Time</td>
                                                    <td class="border border-primary-sidebar-gray-text/70 pl-2 pr-1 sm:pr-5 py-3">Merchant</td>
                                                    <td class="border border-primary-sidebar-gray-text/70 pl-2 pr-1 sm:pr-5 py-3">Service Id</td>
                                                    <td class="border border-primary-sidebar-gray-text/70 pl-2 pr-1 sm:pr-5 py-3">Request Id</td>
                                                    <td class="border border-primary-sidebar-gray-text/70 pl-2 pr-1 sm:pr-5 py-3">Recipient</td>
                                                    <td class="border border-primary-sidebar-gray-text/70 pl-2 pr-1 sm:pr-5 py-3">IP</td>
                                                    <td class="border border-primary-sidebar-gray-text/70 pl-2 pr-1 sm:pr-5 py-3">Uri</td>
                                                    <td class="border border-primary-sidebar-gray-text/70 pl-2 pr-1 sm:pr-5 py-3">Payload</td>
                                                </tr>
                                            </thead>
                                            <tbody class="align-top">
                                                <template x-for="(row, rowIndex) in paginatedData" :key="rowIndex">
                                                    <tr class="hover:bg-gray-50">
                                                        <td x-text="row.date" class="border border-primary-sidebar-gray-text/70 px-2 py-3"></td>
                                                        <td x-text="row.merchant" class="border border-primary-sidebar-gray-text/70 px-2 py-3"></td>
                                                        <td x-text="row.serviceId" class="border border-primary-sidebar-gray-text/70 px-2 py-3"></td>
                                                        <td x-text="row.requestId" class="border border-primary-sidebar-gray-text/70 px-2 py-3"></td>
                                                        <td x-text="row.recipient" class="border border-primary-sidebar-gray-text/70 px-2 py-3"></td>
                                                        <td x-text="row.ip" class="border border-primary-sidebar-gray-text/70 px-2 py-3"></td>
                                                        <td x-text="row.uri" class="border border-primary-sidebar-gray-text/70 px-2 py-3"></td>
                                                        <td x-text="row.payload" class="border border-primary-sidebar-gray-text/70 px-2 py-3"></td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>

                                        <template x-if="totalPages > 1">
                                            <div class="flex mt-4 mb-6">
                                                <div class="inline-flex border border-primary-sidebar-gray-text/70">
                                                    <div 
                                                        :class="{'text-primary-sidebar-gray-text cursor-not-allowed': currentPage === 1, 'text-primary-blue-text cursor-pointer': currentPage > 1}"
                                                        class="border-r border-primary-sidebar-gray-text/70 px-2 py-1 text-sm hover:bg-gray-50"
                                                        @click="goToPage(currentPage - 1)"
                                                    >
                                                        &lt;
                                                    </div>
                                                    <template x-for="page in pageWindow" :key="page">
                                                        <div
                                                            class="px-3 py-1 text-sm border-r border-primary-sidebar-gray-text/70 font-medium transition-all duration-300"
                                                            :class="{ 'bg-primary-cyanBlue-sidebar-background text-white': page === currentPage, 'text-primary-blue-text hover:bg-gray-50 cursor-pointer': page !== currentPage }"
                                                            @click="goToPage(page)"
                                                            x-transition:enter="transition ease-out duration-200"
                                                            x-transition:enter-start="opacity-0 translate-x-2"
                                                            x-transition:enter-end="opacity-100 translate-x-0"
                                                            x-transition:leave="transition ease-in duration-200"
                                                            x-transition:leave-start="opacity-100 translate-x-0"
                                                            x-transition:leave-end="opacity-0 -translate-x-2"
                                                            x-text="page"
                                                        ></div>
                                                    </template>
                                                    
                                                    <div 
                                                        class="font-medium px-2 py-1 text-sm hover:bg-gray-50"
                                                        @click="goToPage(currentPage + 1)"
                                                        :class="{'text-primary-sidebar-gray-text cursor-not-allowed': currentPage === totalPages, 'text-primary-blue-text cursor-pointer': currentPage < totalPages}"
                                                    >
                                                        &gt;
                                                    </div>
                                                </div>
                                            </div>
                                            
                                        </template>
                                    </div>
                                </template>
                                <template x-if="tableData.length === 0">
                                    <p x-text="noDataMessage || 'No data found'" class="text-primary-header-gray-bold font-light text-sm mt-4 mb-8"></p>
                                </template>
                            </div>
                        </div>   
                    </div>

                </div>

                <!-- Footer Section Component  -->
                <div id="contentFooterContainer" x-ref="contentFooterContainer" class="mt-auto"></div>

                <!-- Scroll Up Button Component  -->
                <div id="scrollUpButton" x-ref="scrollUpButton"></div>
            </div>

        </section>
    </body>
    <script type="module" src="../scripts/main.js"></script>
</html>